# SunaStereoShaders
Stereo Shaders for Unity and VRChat  
UnityやVRChatでステレオ立体視映像の撮影や鑑賞をするためのシェーダのセットです。  
Assets/Shaders以下に置いています。

## StereoScreen2tex.shader
左目用カメラの映像と、右目用のカメラの映像を使って、立体映像を表示し、VRで鑑賞するためのシェーダです。  
### 使用方法
1. 左目用と右目用のカメラと、左目用と右目用のレンダーテクスチャを作成します。レンダーテクスチャの縦横比はスクリーンの縦横比に合わせます。
2. 左目用レンダーテクスチャは左目用カメラに、右目用レンダーテクスチャは右目用カメラにアタッチします。
3. 本シェーダをUnityプロジェクトのAssetsフォルダ以下にインポートして、スクリーンにしたいオブジェクト(Quad等)に割り当てたマテリアルのシェーダに、「Unlit/StereoScreen2tex」を指定します。
4. マテリアルのシェーダの設定画面で、「Left Eye Texture」に左目用レンダーテクスチャをアタッチし、「Right Eye Texture」に右目用レンダーテクスチャをアタッチします。
5. VRで動作を確認します。

## StereoScreen1tex.shader
画面の半分に左目用画像、もう半分に右目用画像が表示されている立体視映像を、VR内で立体化して3D映像として鑑賞するためのシェーダです。サイドバイサイド(Side-by-side)の立体視映像などが鑑賞できます。本シェーダで鑑賞するための立体視映像は、後述の「StereoStickRL.shader」で撮影することができます。

## 使用方法
1. 本シェーダをUnityプロジェクトのAssetsフォルダ以下にインポートして、スクリーンにしたいオブジェクト(Quad等)に割り当てたマテリアルのシェーダに、「Unlit/StereoScreen1tex」を指定します。
2. マテリアルのシェーダの設定画面で、「MainTex」に立体視したいテクスチャやレンダーテクスチャをアタッチします。「Extend X」は元の映像に対して、立体視映像の横方向(X方向)が何倍に縮小されているかを示す値で、デフォルトは0.5です。左右に映像が並ぶ場合は片目分の映像の幅が0.5倍に圧縮されていることになります。「LeftShiftX」は左目用の映像の原点をどの程度左にシフトするかを示す値で、デフォルトは0です。「LeftShiftY」は左目用の映像の原点をどの程度上にシフトするかを示す値で、デフォルトは0です。Right系も同様の意味です。「IsAVPro」はAVProVideoというアセットで本シェーダを使う場合にOnにします。
3. 設定ができたらVRで立体映像を鑑賞します。

## StereoStickRL.shader
左目用カメラの映像と、右目用カメラの映像を使って、画面の左半分に左目用映像、画面の右半分に右目用の映像を表示させるためのシェーダです。出力される映像は、平行法の立体視映像となります。

### 使用方法
1. 左目用と右目用のカメラと、左目用と右目用のレンダーテクスチャを作成します。レンダーテクスチャの縦横比はスクリーンの縦横比に合わせます。
2. 左目用レンダーテクスチャは左目用カメラに、右目用レンダーテクスチャは右目用カメラにアタッチします。
3. VRChatのアバターに入れて使う場合は、他人に干渉してしまうことを避けるため、動作判定用のカメラと1x1サイズのレンダーテクスチャを作成します。カメラは、Culling Maskにnothingを指定してClear FlagsをSolid Colorの白に設定します。このカメラに1x1サイズのレンダーテクスチャをアタッチします。VRChatでなくUnityで使う場合はカメラは不要で、1x1の白色テクスチャを使います。
4. 本シェーダをUnityプロジェクトのAssetsフォルダ以下にインポートして、スクリーンにしたいオブジェクト(Quad等)に割り当てたマテリアルのシェーダに、「Unlit/StereoStickRL」を指定します。
5. マテリアルのシェーダの設定画面で、「Left Eye Texture」に左目用レンダーテクスチャをアタッチし、「Right Eye Texture」に右目用レンダーテクスチャをアタッチし、「Switch」に1x1サイズのレンダーテクスチャをアタッチします。「Stick Distance」にはこのシェーダが有効となる範囲を指定します。この距離以内のカメラに映像が表示されます。「Target Screen Ratio」にはターゲットとなる画面の縦横比を設定します。初期値は16:9に近い「1.777」が指定されています。
6. VRChat/Unityで対象のオブジェクトの「Stick Distance」以内に近づき、カメラやストリームカメラを向けると、「Target Screen Ratio」に近い画面に立体視映像が表示されるはずです。
